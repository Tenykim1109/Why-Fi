stages:
  - build
  - deploy

build-front:
  stage: build
  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - project/S06P31D108/frontend/node_modules
  only:
    - master
    - develop
  script:
    # - source "/home/ubuntu/.nvm/nvm.sh"
    - echo $HOME
    - cd $CI_PROJECT_DIR/frontend
    - pwd
    - npm install
    - CI=false npm run build
    - sudo rm -rf $HOME/project/S06P31D108/frontend/build
    - cp -rf build $HOME/project/S06P31D108/frontend
  tags:
    - prd

deploy-front:
  stage: deploy
  only:
    - master
    - develop
  script:
    - ls -al $HOME/project/S06P31D108/frontend/build
  tags:
    - prd
